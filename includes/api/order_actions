<h1 id='order-actions'>Order actions</h1>
<p>Once you have a list of relevant orders to work on, you can perform a limited number of actions on these orders to progress these orders along the order management lifecycle. The order status transitions are governed by a state machine â€“ this state machine will only allow orders to transition between states that valid starting and ending states for a given action. For instance a &#39;pending&#39; order may transition to &#39;processing&#39; but not to &#39;dispatched&#39;.</p>

<p>Any attempt to update an order using an invalid state transition will be met with a 422 (unprocessable entity) and a textual description of the error.</p>

<p>In principle the vast majority of actions a supplier will be performing are:</p>
<h2 id='order-actions-accept'>accept</h2>
<p>This action requires the ID of an order with a current status of &#39;pending&#39;, and results in the order having a new status of &#39;processing&#39;</p>

<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/orders/{id}/accept</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="w">
</span></code></pre></div><h2 id='order-actions-reject'>reject</h2>
<p>This action requires the ID of an order with a current status of &#39;pending&#39;, and results in the order having the status &#39;unable to fulfill&#39;. A reason is required for any order being rejected.</p>

<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/orders/{id}/reject</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Reason for supplier rejecting this order"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>order[reason]</td>
<td>String</td>
<td>Required - text description of why the order cannot be fulfilled and is being rejected. Care should be taken when providing a reason as this will be seen by the end user/customer as well as our reward services team.</td>
</tr>
</tbody></table>
<h2 id='order-actions-dispatch'>dispatch</h2>
<p>This action requires the ID of an order with a current status of &#39;processing&#39;, and results in this order having the status &#39;dispatched&#39;. In order to dispatch an order you will have to provide a date at which the order was dispatched and optionally either a tracking URL or tracking ID or (preferably) both if required to trace the delivery using a courier.</p>

<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/orders/{id}/dispatch</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"dispatch_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-09 12:34:56"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tracking_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tracking_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://tracking.com/123456"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>order[dispatch_date]</td>
<td>DateTime (string)</td>
<td>Required - string parsable as datetime (i.e. 2017-01-01 13:45:56) this should be the date and time the order was despatched at - there are currently no restrictions on whether this date is in the past or present, however logically it should not be before the order was accepted for processing</td>
</tr>
<tr>
<td>order[tracking_id]</td>
<td>String</td>
<td>Optional - this value should represent an identifier or token for tracking the delivery with the relevant courier or handler</td>
</tr>
<tr>
<td>order[tracking_url]</td>
<td>String</td>
<td>Optional - if provided, must be a valid URL (i.e. <code>https://courier.com/track?parcelID=232456</code>) and should allow the user to click and be shown the progress of their delivery.</td>
</tr>
</tbody></table>
